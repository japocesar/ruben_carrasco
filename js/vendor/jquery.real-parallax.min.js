!function(t){function i(i,n){function o(){document.getElementById("l")}var a,s,r,f,u=this,h=jQuery.extend({},{width:i.width(),height:i.height(),enableMouse:!0,activateOnClick:!1,sensitivityX:.5,sensitivityY:.4,easingCoefficient:7,autoZCoordinate:!0,useCustomZ:!0,focusZ:0},n),c=0,d=0,l=0,p=0,v=-1,y=-1,g=new Array,m=new Array,b=!1,w=!1,x=function(){i.width(h.width),i.height(h.height),a=i.children("div"),s=a.length,r=new Array,f=i.css("position"),"static"==f&&i.css("position","relative"),a.css("padding","0"),a.css("margin","0"),a.css("position","absolute"),C(),O(),k(),N(),"static"==f&&i.css("position","static")},C=function(){for(var e=i.offset(),n=0;s>n;n++){r[n]={};var o=parseFloat(jQuery(a[n]).data("z"));isNaN(o)||(r[n].z=o);var f=jQuery(a[n]).data("lock");void 0!=f?("string"==typeof f&&(f=f.replace(/^\s+|\s+$/g,"").toLowerCase()),"false"!=f&&0!=f&&"no"!=f&&(r[n].locked=!0)):r[n].locked=!1;var u=jQuery(a[n]).attr("id");void 0!=u&&(r[n].id=u);var h=t(a[n]).offset();r[n].x=h.left-e.left,r[n].y=h.top-e.top,F(n,r[n].x,r[n].y)}},k=function(){for(var t=100,i=-2*t/s,e=0;s>e;e++)1==h.autoZCoordinate?h.useCustomZ&&void 0!=r[e].z?r[e].z=r[e].z:(r[e].z=t,t+=i):void 0==r[e].z&&(r[e].z=h.focusZ)},N=function(){i.unbind("mousemove",z),i.unbind("mousedown",z),1==h.enableMouse&&(1==h.activateOnClick?i.bind("mousedown",z):i.bind("mousemove",z))},z=function(e){if(0!=h.sensitivityX){var n=t("html").scrollLeft();n||(n=t("body").scrollLeft());var a=e.clientX-i.offset().left+n;a>h.width?a=h.width:0>a&&(a=0),c=a-h.width/2}if(0!=h.sensitivityY){var n=t("html").scrollTop();n||(n=t("body").scrollTop());var s=e.clientY-i.offset().top+n;s>h.height?s=h.height:0>s&&(s=0),d=s-h.height/2}o(""),1==b&&u.stopChain(),M(),I("mouseToRatio",{x:a/h.width,y:s/h.height})},M=function(){j(),-1==v&&(v=setInterval(Z,20))},T=function(){clearInterval(v),v=-1},j=function(){-1!=y&&(clearTimeout(y),y=-1)},F=function(t,i,e){a[t].style.left=i+"px",a[t].style.top=e+"px"},Z=function(){var t=c-l,i=d-p;Math.abs(t)<1&&Math.abs(i)<1&&(T(),A()),l+=t/(1+h.easingCoefficient),p+=i/(1+h.easingCoefficient);for(var e=0;s>e;e++)if(1!=r[e].locked){var n=.01*(r[e].z-h.focusZ);F(e,r[e].x-l*h.sensitivityX*n,r[e].y-p*h.sensitivityY*n)}},O=function(){for(var i=0;s>i;i++)t(a[i]).find(">img").hide().one("load",function(){t(this).fadeIn(800,function(){this.style.removeAttribute("filter")})}).each(function(){this.complete&&this.width>0&&t(this).trigger("load")})},Q=function(){if(g.length>0){var t=g.shift();return 1==w&&g.push(t),t}return!1},A=function(){1==b&&u.startChain(w)},I=function(i,n){if(m.length>0)for(var o=0;o<m.length;o++)t("#"+m[o])[e](i,n)};this.option=function(t,i){if("undefined"!=typeof t)if(t=t.replace(/^\s+|\s+$/g,""),"enableMouse"==t||"activateOnClick"==t){if("undefined"==typeof i)return h[t];h[t]=Boolean(i),N(),"enableMouse"==t&&A()}else if(void 0!=h[t]){if("undefined"==typeof i||isNaN(parseFloat(i)))return h[t];h[t]=parseFloat(i)}},this.layer=function(t,i){if("undefined"!=typeof t){var e=0,n=s,o=!isNaN(parseInt(t));o&&(e=Math.min(parseInt(t),s-1),n=e+1);for(var a=e;n>a;a++)if(1==o||r[a].id==t){if("undefined"==typeof i)return r[a];void 0!=i.x&&(r[a].x=i.x),void 0!=i.y&&(r[a].y=i.y),void 0!=i.z&&(r[a].z=i.z),void 0!=i.locked&&(r[a].locked=Boolean(i.locked)),Z();break}}},this.toggleMouse=function(){h.enableMouse=!h.enableMouse,N(),A()},this.pause=function(t){-1!=v?(T(),t>0&&(j(),y=setTimeout(M,t))):1==b&&(j(),y=setTimeout(A,t))},this.update=function(){Z()},this.unpause=function(){M()},this.triggerPause=function(){-1!=v?T():M()},this.stop=function(){c=l,d=p,A()},this.mouseTo=function(t){var i=c,e=d;"object"==typeof t&&(isNaN(parseFloat(t.x))||(i=t.x-h.width/2),isNaN(parseFloat(t.y))||(e=t.y-h.height/2)),c=i,d=e,M()},this.mouseToRatio=function(t){c=(t.x-.5)*h.width,d=(t.y-.5)*h.height,M()},this.mouseToRandom=function(){c=(.5-Math.random())*h.width,d=(.5-Math.random())*h.height,M()},this.reset=function(){c=0,d=0,M()},this.centerTo=function(t){var i=c,e=d;if("object"==typeof t&&"undefined"!=typeof t.id&&""!=t.id)for(var n=0;s>n;n++)if(r[n].id==t.id){var o=.01*(r[n].z-h.focusZ);if(0!=o){var f=1,u=1,l=0,p=0;"undefined"!=typeof t.align&&""!=t.align&&(t.align=t.align.toLowerCase(),-1!=t.align.indexOf("l")?f=0:-1!=t.align.indexOf("r")&&(f=2),-1!=t.align.indexOf("t")?u=0:-1!=t.align.indexOf("b")&&(u=2)),isNaN(parseFloat(t.offx))||(l=parseFloat(t.offx)),isNaN(parseFloat(t.offy))||(p=parseFloat(t.offy)),0!=h.sensitivityX&&(i=(r[n].x-l-.5*(h.width-f*jQuery(a[n]).width()))/(o*h.sensitivityX)),0!=h.sensitivityY&&(e=(r[n].y-p-.5*(h.height-u*jQuery(a[n]).height()))/(o*h.sensitivityY))}break}c=i,d=e,M()},this.addToChain=function(){void 0!=arguments[0]&&g.push(void 0!=arguments[1]?{method:arguments[0],parameters:arguments[1]}:{method:arguments[0]})},this.clearChain=function(){g=[]},this.startChain=function(t){w=Boolean(t),b=!0,action=Q(),0!=action?void 0!=action.parameters?u[action.method](action.parameters):u[action.method]():b=!1},this.stopChain=function(){b=!1,j(),-1!=v&&T()},this.linkWith=function(){var t=Array.prototype.slice.apply(arguments);m.push(t)},this.resetLinks=function(){m=[]},x()}var e="parallax";t.fn[e]=function(n){var o,a,s=arguments;if(0==this.length)return!1;if(o=t(this),a=o.data(e)){if(a[n])return a[n].apply(this,Array.prototype.slice.call(s,1))}else if("object"==typeof n||!n)return o.data(e,new i(o,n))}}(jQuery);